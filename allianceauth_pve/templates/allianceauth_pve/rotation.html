{% extends 'allianceauth/base.html' %}
{% load static %}
{% load evelinks %}
{% load humanize %}

{% block page_title %}Rotation {{ rotation.name }}{% endblock page_title %}
{% block extra_css %}
<style>
    .row-pve {
        display: flex;
    }
    
    .column-pve {
        flex: 50%;
        padding: 10px;
    }

    hr {
        min-height: 100%;
        max-height: 100vh;
        margin: 0;
    }

    {% comment %} hr {
        border: 0;
        clear:both;
        display:block;
        width: 1px;               
        height: 96%;
    } {% endcomment %}
</style>
{% endblock extra_css %}

{% block content %}
    <div class="col-lg-12">
        <h1 class="page-header text-center">Rotation: {{ rotation.name }}</h1>
        <div class="row-pve panel panel-default">
            <div class="column-pve">
                <p class="text-center">Age</p>
                <p class="text-center">{{ rotation.days_since }} days</p>
            </div>
            <div class="column-pve">
                <p class="text-center">Estimated Total</p>
                <p class="text-center">{{ rotation.estimated_total|floatformat:0|intcomma }}</p>
            </div>
            {% if rotation.is_closed %}
            <div class="column-pve">
                <p class="text-center">Actual Total</p>
                <p class="text-center">{{ rotation.actual_total|floatformat:0|intcomma }}</p>
            </div>
            {% endif %}
            <div class="column-pve">
                <p class="text-center">Tax Rate</p>
                <p class="text-center">{{ rotation.tax_rate|floatformat }} %</p>
            </div>
        </div>
        <div class="row-pve panel panel-default">
            <div class="column-pve">
                <table class="table table-aa">
                    <thead>
                        <tr>
                            <th>Character</th>
                            <th>Setups</th>
                            {% if rotation.is_closed %}
                                <th>Actual Total</th>
                                <th>Estimated Total</th>
                            {% else %}
                                <th>Total</th>
                            {% endif %}
                        </tr>
                    </thead>

                    <tbody>
                        {% for row in summary_first %}
                            <tr>
                                <td>
                                    <img src="{{ row.character|character_portrait_url:32 }}" class="img-circle" style="margin-right: 1rem;">
                                    {{ row.character.character_name }}
                                </td>
                                <td>{{ row.helped_setups }}</td>
                                {% if rotation.is_closed %}
                                    <td>{{ row.actual_total|floatformat:0|intcomma }}</td>
                                {% endif %}
                                <td>{{ row.estimated_total|floatformat:0|intcomma }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="column-pve">
                <table class="table table-aa">
                    <thead>
                        <tr>
                            <th>Character</th>
                            <th>Setups</th>
                            {% if rotation.is_closed %}
                                <th>Actual Total</th>
                                <th>Estimated Total</th>
                            {% else %}
                                <th>Total</th>
                            {% endif %}
                        </tr>
                    </thead>

                    <tbody>
                        {% for row in summary_second %}
                            <tr>
                                <td>
                                    <img src="{{ row.character|character_portrait_url:32 }}" class="img-circle" style="margin-right: 1rem;">
                                    {{ row.character.character_name }}
                                </td>
                                <td>{{ row.helped_setups }}</td>
                                {% if rotation.is_closed %}
                                    <td>{{ row.actual_total|floatformat:0|intcomma }}</td>
                                {% endif %}
                                <td>{{ row.estimated_total|floatformat:0|intcomma }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title text-center">Entries</h3>
            </div>
            <div class="panel-body">
                
            </div>
        </div>
    </div>
{% endblock content %}